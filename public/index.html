<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Rhyme.ai</h1>
  <p>From prompt to poetry</p>

  <form class="form-container" id="poem-form">
    <textarea
      id='prompt'
      name='user_input' 
      cols="50"
      rows="5"
      placeholder="Enter a brief description, themes, ideas of what you want to poetically express"></textarea>
    <button type="submit">Submit</button>
  </form>

  <div class='poem-container'>
    <div class='prompt'></div>
    <div class='title'></div>
    <div class='poem'></div>
    <div>
      <button class='regen-poem'>Regenerate Poem</button>
      <button class='new-poem'>Create new Poem</button>
    </div>
  </div>

  <script>
    let form_container = document.querySelector('.form-container');
    let user_input = document.getElementById('prompt');
  
    let poem_container = document.querySelector('.poem-container');
    let poem_prompt = document.querySelector('.prompt');
    let poem_title = document.querySelector('.title');
    let new_poem = document.querySelector(".poem");
  
    async function fetchResponse() {
      try {
        const response = await fetch("/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ prompt: user_input.value }),
        });
  
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
  
        const responseData = await response.json();
        console.log(responseData.poem);
        return responseData;
      } catch (error) {
        console.error('Error during fetch:', error);
        return null;
      }
    }
  
    function submit_prompt() {
      async function handleSubmit(event) {
        event.preventDefault();
        form_container.style.display = "none";
        poem_container.style.display = "flex";
        console.log(user_input.value);
        poem_prompt.innerHTML = `<p>Poem Prompt: ${user_input.value}</p>`;
        const responseText = await fetchResponse();
        console.log(responseText.poem)
  
        if (responseText) {
          poem_title.innerHTML = `<h2>${responseText.title}</h2>`;
          new_poem.innerHTML = `<p>${responseText.poem}</p>`;
        }
      }
  
      form_container.addEventListener("submit", handleSubmit);
    }
  
    submit_prompt();
  </script>

</body>



</html>
